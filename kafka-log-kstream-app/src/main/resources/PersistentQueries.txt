CREATE STREAM LOGS_ERROR_FILTERED WITH (KAFKA_TOPIC='LOGS_ERROR_FILTERED', PARTITIONS=1, REPLICAS=3, VALUE_FORMAT='AVRO') AS SELECT
  RAWLOGS.LOGID,
  RAWLOGS.INFOLEVEL,
  RAWLOGS.LOGSTRING
FROM RAWLOGS
WHERE (RAWLOGS.INFOLEVEL = 'ERROR')
EMIT CHANGES;

CREATE STREAM LOGS_WARNING_FILTERED WITH (KAFKA_TOPIC='LOGS_WARNING_FILTERED', PARTITIONS=1, REPLICAS=3, VALUE_FORMAT='AVRO') AS SELECT
  RAWLOGS.LOGID,
  RAWLOGS.INFOLEVEL,
  RAWLOGS.LOGSTRING
FROM RAWLOGS
WHERE (RAWLOGS.INFOLEVEL = 'WARNING')
EMIT CHANGES;

CREATE STREAM LOGS_INFO_FILTERED WITH (KAFKA_TOPIC='LOGS_INFO_FILTERED', PARTITIONS=1, REPLICAS=3, VALUE_FORMAT='AVRO') AS SELECT
  RAWLOGS.LOGID,
  RAWLOGS.INFOLEVEL,
  RAWLOGS.LOGSTRING
FROM RAWLOGS
WHERE (RAWLOGS.INFOLEVEL = 'INFO')
EMIT CHANGES;

CREATE STREAM LOGS_DEBUG_FILTERED WITH (KAFKA_TOPIC='LOGS_DEBUG_FILTERED', PARTITIONS=1, REPLICAS=3, VALUE_FORMAT='AVRO') AS SELECT
  RAWLOGS.LOGID,
  RAWLOGS.INFOLEVEL,
  RAWLOGS.LOGSTRING
FROM RAWLOGS
WHERE (RAWLOGS.INFOLEVEL = 'DEBUG')
EMIT CHANGES;